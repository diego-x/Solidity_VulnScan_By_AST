<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>智能合约漏洞检测报告</title>
<!-- 导入需要的包 -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlightjs@9.16.2/styles/darcula.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.5.1/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlightjs-line-numbers.js/2.8.0/highlightjs-line-numbers.min.js"></script>
</head>

<body style="background: url(/public/images/trees.webp) ; background-size:100% 100% ; background-attachment: fixed">
    <div style="border: 1px solid #ffffff; width: 1200px; height: 500px;margin: 0 auto;">      
        <h2>智能合约代码</h2>
        <pre>
            <code>pragma solidity >=0.7.0 <0.9.0;

contract Storage {

    function batchTransfer(address[] _receivers, uint256 _value) public whenNotPaused returns (bool) {
        uint cnt = _receivers.length;
        uint256 amount = uint256(cnt) * _value; //溢出点，这里存在整数溢出
        c = a + amount; 
        require(cnt > 0 && cnt <= 20);
        require(_value > 0 && balances[msg.sender] >= amount);

        balances[msg.sender] = balances[msg.sender].sub(amount);
        for (uint i = 0; i < cnt; i++) {
            balances[_receivers[i]] = balances[_receivers[i]].add(_value);
            Transfer(msg.sender, _receivers[i], _value);
        }
        return true;
  }
}</code>
        </pre>

        <h2>溢出漏洞</h2>

合约<font color="red" size="4">Storage</font> 函数<font color="red" size="4">batchTransfer</font> 行<font color="red" size="4">7</font> 传入的参数 <font color="red" size="4">_value</font> 直接或间接参与数学运算 <font color="red" size="4">污染链(_value -> amount -> c)</font>, 同时没有采用<font color="red" size="4">SafeMath</font>库
<pre><font size="4"><code> uint256 amount = uint256(cnt) * _value; //溢出点，这里存在整数溢出<code></font></pre><br>合约<font color="red" size="4">Storage</font> 函数<font color="red" size="4">batchTransfer</font> 行<font color="red" size="4">8</font> 传入的参数 <font color="red" size="4">_value</font> 直接或间接参与数学运算 <font color="red" size="4">污染链(_value -> amount -> c)</font>, 同时没有采用<font color="red" size="4">SafeMath</font>库
<pre><font size="4"><code> c = a + amount;<code></font></pre><br><h2>tx.origin依赖漏洞</h2>

<h2>重入漏洞</h2>

<h2>危险函数调用</h2>

<h2>未检查返回值</h2>


        <script>
            // 开启代码高亮
            hljs.initHighlightingOnLoad();
            // 行号显示
            hljs.initLineNumbersOnLoad ({ singleLine:true });
        </script>
    </div>
</body>

</html>
